<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="src/assets/css/style.css">
</head>

<body class="bg-[#f1eeeb]">

  <!-- Load Components -->
  <div id="navigation"></div>
  <div id="main-section"></div>
  <div id="subcomponent"></div>
  <div id="parterners"></div>
  <div id="contact"></div>
  <div id="footer"></div>

  <script>
    const loadComponents = (id, url) => {
      fetch(url)
        .then((response) => response.text())
        .then((html) => {
          document.getElementById(id).innerHTML = html;

          if (id === 'navigation') {
            const menuBtn = document.getElementById("menuBtn");
            const mobileMenu = document.getElementById("mobileMenu");
            if (menuBtn) {
              menuBtn.addEventListener("click", () => {
                mobileMenu.classList.toggle("hidden");
                menuBtn.textContent = mobileMenu.classList.contains("hidden") ? "â˜°" : "X";
              });
            }

            attachNavLinks();
          }
        });
    }

    function attachNavLinks() {
      const sectionMap = {
        about: "about-info",
        service: "service-info"
      };

      Object.keys(sectionMap).forEach(key => {
        const desktopLink = document.getElementById(`${key}-link-desktop`);
        const mobileLink = document.getElementById(`${key}-link-mobile`);
        
        if (desktopLink) {
          desktopLink.addEventListener("click", e => {
            e.preventDefault();
            loadSubcomponent(sectionMap[key]);
          });
        }

        if (mobileLink) {
          mobileLink.addEventListener("click", e => {
            e.preventDefault();
            loadSubcomponent(sectionMap[key]);
            document.getElementById("mobileMenu").classList.add("hidden");
          });
        }
      });
    }

    function loadSubcomponent(targetId) {
      const container = document.getElementById("subcomponent");

      fetch('src/components/subcomponent-main-section.html')
        .then(res => res.text())
        .then(html => {
          const tempDiv = document.createElement('div');
          tempDiv.innerHTML = html;
          const section = tempDiv.querySelector(`#${targetId}`);

          if (section) {
            container.innerHTML = section.outerHTML;
            container.scrollIntoView({ behavior: "smooth" });
          } else {
            container.innerHTML = `<p>Section "${targetId}" not found!</p>`;
          }
        });
    }

    window.onload = () => {
      loadComponents('navigation', 'src/components/navigation.html');
      loadComponents('footer', 'src/components/footer.html');
      loadComponents('main-section', 'src/components/main-section.html');
      loadComponents('parterners', 'src/components/parterners.html');
      loadComponents('contact', 'src/components/contact.html');
      loadComponents('subcomponent', 'src/components/subcomponent-main-section.html');
    }
  </script>

</body>

</html>
